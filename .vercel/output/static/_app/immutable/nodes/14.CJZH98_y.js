import{t as f,a as n}from"../chunks/DKJ7Mg52.js";import{p as I,q as J,s as m,f as K,a as L,$ as M,c,r as u,b as x,t as Q,g as p,d as r,n as R}from"../chunks/AQxm7BEp.js";import{s as B}from"../chunks/C_FN1Gfx.js";import{i as A}from"../chunks/CcEstl9Z.js";import{h as U}from"../chunks/BBvt7ttV.js";import{d as W}from"../chunks/B5Im49L4.js";import{s as V}from"../chunks/CSYD9VDW.js";import{p as X}from"../chunks/kBZY_V6L.js";import{s as Z,a as aa}from"../chunks/DOAtbWT_.js";import{p as sa}from"../chunks/Cm_25bjD.js";import{S as ta}from"../chunks/DtGR0qmV.js";const ea=(P,o,l,i,w,y,a)=>{r(o,!0),r(l,"Sending...");let d=i==null?void 0:i.email;d&&w.auth.resetPasswordForEmail(d,{redirectTo:`${y().url.origin}/auth/callback?next=%2Faccount%2Fsettings%2Freset_password`}).then(v=>{r(a,X(!v.error)),r(o,!1),r(l,"Send Forgot Password Email")})};var oa=f(`<div class="font-bold">Set Password By Email</div> <div>You use oAuth to sign in ("Sign in with Github" or similar). You can
          continue to access your account using only oAuth if you like!</div>`,1),ia=f('<div class="font-bold">Change Password By Email</div>'),ra=f(`<div class="card p-6 pb-7 mt-8 max-w-xl flex flex-col md:flex-row shadow max-w-md"><div class="flex flex-col gap-y-4"><!> <div> </div> <button> </button> <div>Sent email! Please check your inbox and use the link to set your
        password.</div></div></div>`),la=f('<h1 class="text-2xl font-bold mb-6">Change Password</h1> <!>',1);function ba(P,o){var $,k;I(o,!0);const[l,i]=Z(),w=()=>aa(sa,"$page",l);J("adminSection").set("settings");let{user:a,supabase:d}=o.data,v=!!(($=a==null?void 0:a.amr)!=null&&$.find(s=>s.method==="password")),N=!!((k=a==null?void 0:a.amr)!=null&&k.find(s=>s.method==="oauth")),S=x(!1),C=x("Send Set Password Email"),h=x(!1);var T=la();U(s=>{M.title="Change Password"});var O=m(K(T),2);{var Y=s=>{ta(s,{title:"Change Password",editable:!0,saveButtonTitle:"Change Password",successTitle:"Password Changed",successBody:"On next sign in, use your new password.",formTarget:"/account/api?/updatePassword",fields:[{id:"newPassword1",label:"New Password",initialValue:"",inputType:"password"},{id:"newPassword2",label:"Confirm New Password",initialValue:"",inputType:"password"},{id:"currentPassword",label:"Current Password",initialValue:"",inputType:"password"}]})},q=s=>{var g=ra(),E=c(g),F=c(E);{var G=e=>{var _=oa();R(2),n(e,_)},j=e=>{var _=ia();n(e,_)};A(F,e=>{N?e(G):e(j,!1)})}var b=m(F,2),z=c(b);u(b);var t=m(b,2);t.__click=[ea,S,C,a,d,w,h];var D=c(t,!0);u(t);var H=m(t,2);u(E),u(g),Q(()=>{B(z,`The button below will send you an email at ${(a==null?void 0:a.email)??""} which will allow
        you to set your password.`),V(t,`btn btn-outline btn-wide ${(p(h)?"hidden":"")??""}`),t.disabled=p(S),B(D,p(C)),V(H,`success alert alert-success ${(p(h)?"":"hidden")??""}`)}),n(s,g)};A(O,s=>{v?s(Y):s(q,!1)})}n(P,T),L(),i()}W(["click"]);export{ba as component};
